<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="木头">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="木头">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="木头">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>木头</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">木头</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">This is your journey</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/08/8b-10b编解码器的Verilog实现/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="sjinglong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木头">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/08/8b-10b编解码器的Verilog实现/" itemprop="url">8b/10b编解码器的Verilog实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-08T13:28:13+08:00">
                2019-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>我用于测试的图片大小为 269*269 的，如果你的图片大小不同，就还得修改一些地方。写的比较仓促，我水平也有限，将就参考参考吧</p>
</blockquote>
<h6 id="这是我用于测试的图片："><a href="#这是我用于测试的图片：" class="headerlink" title="这是我用于测试的图片："></a>这是我用于测试的图片：</h6><p><img src="http://i350.photobucket.com/albums/q439/wood_/face_zpsqpii7rp3.jpg" alt="1.jpg"></p>
<h3 id="8b-10b-编码器"><a href="#8b-10b-编码器" class="headerlink" title="8b/10b 编码器"></a>8b/10b 编码器</h3><p>首先生成需要编码的文件，这个文件以 0xBC 为同步码，以 0xFD 为帧头，以 0xFB 为帧尾，帧头和帧尾之间包含 64 字节的数据，数据包于数据包之间的同步码为 8 个，这个地方我用 C++ 和 OpenCV 实现，代码如下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get_data.cpp: 定义控制台应用程序的入口点。</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdafx.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">same_step</span><span class="params">(ofstream &amp;ofs)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">begin_data</span><span class="params">(ofstream &amp;ofs)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">end_data</span><span class="params">(ofstream &amp;ofs)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">send_data</span><span class="params">(ofstream &amp;ofs, Mat_&lt;uchar&gt;::iterator &amp;it_begin, Mat_&lt;uchar&gt;::iterator &amp;it_end)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Mat img = imread(<span class="string">"1.jpg"</span>);</span><br><span class="line">	<span class="keyword">if</span> (!img.data)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"当前文件夹下没有命名为 1.jpg 的图片存在"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cvtColor(img, img, COLOR_BGR2GRAY);</span><br><span class="line">	ofstream out;</span><br><span class="line">	out.open(<span class="string">"./data.txt"</span>);</span><br><span class="line">	</span><br><span class="line">	Mat_&lt;uchar&gt;::iterator it_begin = img.begin&lt;uchar&gt;();</span><br><span class="line">	Mat_&lt;uchar&gt;::iterator it_end = img.end&lt;uchar&gt;();</span><br><span class="line"></span><br><span class="line">	same_step(out);</span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (it_begin != it_end)</span><br><span class="line">		&#123;</span><br><span class="line">			begin_data(out);</span><br><span class="line">			<span class="keyword">if</span> (send_data(out, it_begin, it_end))</span><br><span class="line">			&#123;</span><br><span class="line">				end_data(out);</span><br><span class="line">				same_step(out);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				end_data(out);</span><br><span class="line">				same_step(out);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	imshow(<span class="string">"img"</span>, img);</span><br><span class="line">	waitKey(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">same_step</span><span class="params">(ofstream &amp;ofs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">		ofs &lt;&lt; <span class="keyword">int</span>(<span class="number">0xBC</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">begin_data</span><span class="params">(ofstream &amp;ofs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ofs &lt;&lt; <span class="keyword">int</span>(<span class="number">0xFD</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">end_data</span><span class="params">(ofstream &amp;ofs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ofs &lt;&lt; <span class="keyword">int</span>(<span class="number">0xFB</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">send_data</span><span class="params">(ofstream &amp;ofs, Mat_&lt;uchar&gt;::iterator &amp;it_begin, Mat_&lt;uchar&gt;::iterator &amp;it_end)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (it_begin != it_end)</span><br><span class="line">		&#123;</span><br><span class="line">			ofs &lt;&lt; <span class="keyword">int</span>(*it_begin) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">			++it_begin;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			ofs &lt;&lt; <span class="keyword">int</span>(<span class="number">0xFB</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (it_begin != it_end)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行这个程序就可以生成名为 data.txt 的待编码文件，下面用 Verilog 实现编码器</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">// Company: </span></span><br><span class="line"><span class="comment">// Engineer: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Create Date: 2018/12/13 16:17:52</span></span><br><span class="line"><span class="comment">// Design Name: </span></span><br><span class="line"><span class="comment">// Module Name: top</span></span><br><span class="line"><span class="comment">// Project Name: </span></span><br><span class="line"><span class="comment">// Target Devices: </span></span><br><span class="line"><span class="comment">// Tool Versions: </span></span><br><span class="line"><span class="comment">// Description: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Dependencies: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Revision:</span></span><br><span class="line"><span class="comment">// Revision 0.01 - File Created</span></span><br><span class="line"><span class="comment">// Additional Comments:</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> top(</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] data_i,</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">9</span>:<span class="number">0</span>] data_o</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">9</span>:<span class="number">0</span>] trans_data = &#123;<span class="number">2'b01</span>, <span class="number">8'hbc</span>&#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">15</span>:<span class="number">0</span>] clk_cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">reg</span> clk2MHz = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (clk_cnt != <span class="number">250</span>)</span><br><span class="line">                clk_cnt &lt;= clk_cnt + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">begin</span></span><br><span class="line">                    clk2MHz &lt;= ~clk2MHz;</span><br><span class="line">                    clk_cnt &lt;= <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(data_i)</span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">            clk2MHz &lt;= <span class="number">0</span>;</span><br><span class="line">            clk_cnt &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">     </span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] same_step_cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] data_cnt = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">parameter</span> INIT = <span class="number">3'b000</span>;</span><br><span class="line">    <span class="keyword">parameter</span> STATE_JUDGE = <span class="number">3'b101</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] cur_state = INIT;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] data_buf;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">reg</span> trans_flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk2MHz)</span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (cur_state)</span><br><span class="line">                INIT:</span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        data_buf &lt;= data_i;</span><br><span class="line">                        cur_state &lt;= STATE_JUDGE;</span><br><span class="line">                        trans_data &lt;= &#123;<span class="number">2'b01</span>, <span class="number">8'hbc</span>&#125;;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                STATE_JUDGE:</span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        <span class="keyword">if</span> (data_buf == <span class="number">8'hbc</span> &amp;&amp; data_i == <span class="number">8'hbc</span> &amp;&amp; data_cnt == <span class="number">0</span>)</span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                                trans_data &lt;= &#123;<span class="number">2'b01</span>, <span class="number">8'hbc</span>&#125;;</span><br><span class="line">                                data_buf &lt;= data_i;</span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (data_buf == <span class="number">8'hbc</span> &amp;&amp; data_i == <span class="number">8'hfd</span> &amp;&amp; data_cnt == <span class="number">0</span>)</span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                                trans_data &lt;= &#123;<span class="number">2'b01</span>, <span class="number">8'hfd</span>&#125;;</span><br><span class="line">                                data_buf &lt;= data_i;</span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (data_buf == <span class="number">8'hfb</span> &amp;&amp; data_i == <span class="number">8'hbc</span> &amp;&amp; data_cnt == <span class="number">0</span>)</span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                                trans_data &lt;= &#123;<span class="number">2'b01</span>, <span class="number">8'hbc</span>&#125;;</span><br><span class="line">                                data_buf &lt;= data_i;</span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                                <span class="keyword">if</span> (data_cnt != <span class="number">64</span>)</span><br><span class="line">                                    <span class="keyword">begin</span></span><br><span class="line">                                        trans_data &lt;= &#123;<span class="number">2'b00</span>, data_i&#125;;</span><br><span class="line">                                        data_cnt &lt;= data_cnt + <span class="number">1</span>;</span><br><span class="line">                                        data_buf &lt;= data_i;</span><br><span class="line">                                    <span class="keyword">end</span></span><br><span class="line">                                <span class="keyword">else</span></span><br><span class="line">                                    <span class="keyword">begin</span></span><br><span class="line">                                        trans_data &lt;= &#123;<span class="number">2'b01</span>, <span class="number">8'hfb</span>&#125;;</span><br><span class="line">                                        data_cnt &lt;= <span class="number">0</span>;</span><br><span class="line">                                        data_buf &lt;= data_i;</span><br><span class="line">                                    <span class="keyword">end</span>    </span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">            trans_flag &lt;= ~trans_flag;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    data_encoder encoder_(</span><br><span class="line">        <span class="variable">.clk</span>(clk),</span><br><span class="line">        <span class="variable">.i_data</span>(trans_data),</span><br><span class="line">        <span class="variable">.o_data</span>(data_o),</span><br><span class="line">        <span class="variable">.trans_triger</span>(trans_flag)</span><br><span class="line">        );</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> data_encoder(</span><br><span class="line">	<span class="keyword">input</span> clk,</span><br><span class="line">	<span class="keyword">input</span> [<span class="number">9</span>:<span class="number">0</span>] i_data,</span><br><span class="line">	<span class="keyword">input</span> trans_triger,</span><br><span class="line">	<span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">9</span>:<span class="number">0</span>] o_data</span><br><span class="line">	);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">parameter</span> DATA526 = <span class="number">4'b0000</span>;</span><br><span class="line">	<span class="keyword">parameter</span> DATA324 = <span class="number">4'b0001</span>;</span><br><span class="line">	<span class="keyword">parameter</span> JUDGE526 = <span class="number">4'b0010</span>;</span><br><span class="line">	<span class="keyword">parameter</span> JUDGE324 = <span class="number">4'b0011</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">parameter</span> JUDGECODE = <span class="number">4'b0100</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">parameter</span> K8210 = <span class="number">4'b0101</span>;</span><br><span class="line">	<span class="keyword">parameter</span> KJUDGE = <span class="number">4'b0110</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] cur_state = JUDGECODE, next_state = JUDGECODE;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">reg</span> rd_flag = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">reg</span> trans_flag = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">always</span> @(trans_triger)</span><br><span class="line">		<span class="keyword">begin</span></span><br><span class="line">			trans_flag &lt;= <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</span><br><span class="line">		<span class="keyword">begin</span></span><br><span class="line">			<span class="keyword">if</span> (trans_flag)</span><br><span class="line">				cur_state &lt;= next_state;</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">always</span> @(cur_state)</span><br><span class="line">		<span class="keyword">begin</span></span><br><span class="line">			<span class="keyword">case</span> (cur_state)</span><br><span class="line">			    JUDGECODE:</span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        <span class="keyword">if</span> (i_data[<span class="number">9</span>:<span class="number">8</span>] == <span class="number">2'b00</span>)</span><br><span class="line">                            next_state &lt;= DATA526;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (i_data[<span class="number">9</span>:<span class="number">8</span>] == <span class="number">2'b01</span>)</span><br><span class="line">                            next_state &lt;= K8210;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            <span class="keyword">begin</span></span><br><span class="line">                                trans_flag &lt;= <span class="number">0</span>;</span><br><span class="line">                                next_state &lt;= JUDGECODE;</span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">end</span>     </span><br><span class="line">				DATA526:</span><br><span class="line">					<span class="keyword">begin</span></span><br><span class="line">						o_data[<span class="number">9</span>:<span class="number">4</span>] &lt;= encoder526(i_data[<span class="number">4</span>:<span class="number">0</span>]);</span><br><span class="line">						next_state &lt;= JUDGE526;</span><br><span class="line">					<span class="keyword">end</span></span><br><span class="line">				DATA324:</span><br><span class="line">					<span class="keyword">begin</span></span><br><span class="line">						o_data[<span class="number">3</span>:<span class="number">0</span>] &lt;= encoder324(i_data[<span class="number">7</span>:<span class="number">5</span>]);</span><br><span class="line">						next_state &lt;= JUDGE324;</span><br><span class="line">					<span class="keyword">end</span></span><br><span class="line">				JUDGE526:</span><br><span class="line">					<span class="keyword">begin</span></span><br><span class="line">						<span class="keyword">if</span> (o_data[<span class="number">9</span>] + o_data[<span class="number">8</span>] + o_data[<span class="number">7</span>] + o_data[<span class="number">6</span>] + o_data[<span class="number">5</span>] + o_data[<span class="number">4</span>] != <span class="number">3</span>)</span><br><span class="line">							rd_flag &lt;= ~rd_flag;</span><br><span class="line">						next_state &lt;= DATA324;</span><br><span class="line">					<span class="keyword">end</span></span><br><span class="line">				JUDGE324:</span><br><span class="line">					<span class="keyword">begin</span></span><br><span class="line">						<span class="keyword">if</span> (o_data[<span class="number">3</span>] + o_data[<span class="number">2</span>] + o_data[<span class="number">1</span>] + o_data[<span class="number">0</span>] != <span class="number">2</span>)</span><br><span class="line">							rd_flag &lt;= ~rd_flag;</span><br><span class="line">						next_state &lt;= JUDGECODE;</span><br><span class="line">						trans_flag &lt;= <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">end</span></span><br><span class="line">                K8210:</span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        o_data &lt;= kencoder(i_data);</span><br><span class="line">                        next_state &lt;= KJUDGE;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                KJUDGE:</span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        <span class="keyword">if</span> (o_data[<span class="number">0</span>] + o_data[<span class="number">1</span>] + o_data[<span class="number">2</span>] + o_data[<span class="number">3</span>] + o_data[<span class="number">4</span>] + o_data[<span class="number">5</span>] + o_data[<span class="number">6</span>] + o_data[<span class="number">7</span>] + o_data[<span class="number">8</span>] + o_data[<span class="number">9</span>] != <span class="number">5</span>)</span><br><span class="line">                            rd_flag &lt;= ~rd_flag;</span><br><span class="line">                        next_state &lt;= JUDGECODE;</span><br><span class="line">                        trans_flag &lt;= <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">			<span class="keyword">endcase</span></span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">function</span> [<span class="number">5</span>:<span class="number">0</span>] encoder526;</span><br><span class="line">		<span class="keyword">input</span> [<span class="number">4</span>:<span class="number">0</span>] i_data526;</span><br><span class="line">		<span class="keyword">if</span> (rd_flag == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">case</span> (i_data526)</span><br><span class="line">				<span class="number">5'b00000</span>: encoder526 = <span class="number">6'b100111</span>;</span><br><span class="line">				<span class="number">5'b00001</span>: encoder526 = <span class="number">6'b011101</span>;</span><br><span class="line">				<span class="number">5'b00010</span>: encoder526 = <span class="number">6'b101101</span>;</span><br><span class="line">				<span class="number">5'b00011</span>: encoder526 = <span class="number">6'b110001</span>;</span><br><span class="line">				<span class="number">5'b00100</span>: encoder526 = <span class="number">6'b110101</span>;</span><br><span class="line">				<span class="number">5'b00101</span>: encoder526 = <span class="number">6'b101001</span>;</span><br><span class="line">				<span class="number">5'b00110</span>: encoder526 = <span class="number">6'b011001</span>;</span><br><span class="line">				<span class="number">5'b00111</span>: encoder526 = <span class="number">6'b111000</span>;</span><br><span class="line">				<span class="number">5'b01000</span>: encoder526 = <span class="number">6'b111001</span>;</span><br><span class="line">				<span class="number">5'b01001</span>: encoder526 = <span class="number">6'b100101</span>;</span><br><span class="line">				<span class="number">5'b01010</span>: encoder526 = <span class="number">6'b010101</span>;</span><br><span class="line">				<span class="number">5'b01011</span>: encoder526 = <span class="number">6'b110100</span>;</span><br><span class="line">				<span class="number">5'b01100</span>: encoder526 = <span class="number">6'b001101</span>;</span><br><span class="line">				<span class="number">5'b01101</span>: encoder526 = <span class="number">6'b101100</span>;</span><br><span class="line">				<span class="number">5'b01110</span>: encoder526 = <span class="number">6'b011100</span>;</span><br><span class="line">				<span class="number">5'b01111</span>: encoder526 = <span class="number">6'b010111</span>;</span><br><span class="line">				<span class="number">5'b10000</span>: encoder526 = <span class="number">6'b011011</span>;</span><br><span class="line">				<span class="number">5'b10001</span>: encoder526 = <span class="number">6'b100011</span>;</span><br><span class="line">				<span class="number">5'b10010</span>: encoder526 = <span class="number">6'b010011</span>;</span><br><span class="line">				<span class="number">5'b10011</span>: encoder526 = <span class="number">6'b110010</span>;</span><br><span class="line">				<span class="number">5'b10100</span>: encoder526 = <span class="number">6'b001011</span>;</span><br><span class="line">				<span class="number">5'b10101</span>: encoder526 = <span class="number">6'b101010</span>;</span><br><span class="line">				<span class="number">5'b10110</span>: encoder526 = <span class="number">6'b011010</span>;</span><br><span class="line">				<span class="number">5'b10111</span>: encoder526 = <span class="number">6'b111010</span>;</span><br><span class="line">				<span class="number">5'b11000</span>: encoder526 = <span class="number">6'b110011</span>;</span><br><span class="line">				<span class="number">5'b11001</span>: encoder526 = <span class="number">6'b100110</span>;</span><br><span class="line">				<span class="number">5'b11010</span>: encoder526 = <span class="number">6'b010110</span>;</span><br><span class="line">				<span class="number">5'b11011</span>: encoder526 = <span class="number">6'b110110</span>;</span><br><span class="line">				<span class="number">5'b11100</span>: encoder526 = <span class="number">6'b001110</span>;</span><br><span class="line">				<span class="number">5'b11101</span>: encoder526 = <span class="number">6'b101110</span>;</span><br><span class="line">				<span class="number">5'b11110</span>: encoder526 = <span class="number">6'b011110</span>;</span><br><span class="line">				<span class="number">5'b11111</span>: encoder526 = <span class="number">6'b101011</span>;</span><br><span class="line">			<span class="keyword">endcase</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">case</span> (i_data526)</span><br><span class="line">				<span class="number">5'b00000</span>: encoder526 = <span class="number">6'b011000</span>;</span><br><span class="line">				<span class="number">5'b00001</span>: encoder526 = <span class="number">6'b100010</span>;</span><br><span class="line">				<span class="number">5'b00010</span>: encoder526 = <span class="number">6'b010010</span>;</span><br><span class="line">				<span class="number">5'b00011</span>: encoder526 = <span class="number">6'b110001</span>;</span><br><span class="line">				<span class="number">5'b00100</span>: encoder526 = <span class="number">6'b001010</span>;</span><br><span class="line">				<span class="number">5'b00101</span>: encoder526 = <span class="number">6'b101001</span>;</span><br><span class="line">				<span class="number">5'b00110</span>: encoder526 = <span class="number">6'b011001</span>;</span><br><span class="line">				<span class="number">5'b00111</span>: encoder526 = <span class="number">6'b000111</span>;</span><br><span class="line">				<span class="number">5'b01000</span>: encoder526 = <span class="number">6'b000110</span>;</span><br><span class="line">				<span class="number">5'b01001</span>: encoder526 = <span class="number">6'b100101</span>;</span><br><span class="line">				<span class="number">5'b01010</span>: encoder526 = <span class="number">6'b010101</span>;</span><br><span class="line">				<span class="number">5'b01011</span>: encoder526 = <span class="number">6'b110100</span>;</span><br><span class="line">				<span class="number">5'b01100</span>: encoder526 = <span class="number">6'b001101</span>;</span><br><span class="line">				<span class="number">5'b01101</span>: encoder526 = <span class="number">6'b101100</span>;</span><br><span class="line">				<span class="number">5'b01110</span>: encoder526 = <span class="number">6'b011100</span>;</span><br><span class="line">				<span class="number">5'b01111</span>: encoder526 = <span class="number">6'b101000</span>;</span><br><span class="line">				<span class="number">5'b10000</span>: encoder526 = <span class="number">6'b100100</span>;</span><br><span class="line">				<span class="number">5'b10001</span>: encoder526 = <span class="number">6'b100011</span>;</span><br><span class="line">				<span class="number">5'b10010</span>: encoder526 = <span class="number">6'b010011</span>;</span><br><span class="line">				<span class="number">5'b10011</span>: encoder526 = <span class="number">6'b110010</span>;</span><br><span class="line">				<span class="number">5'b10100</span>: encoder526 = <span class="number">6'b001011</span>;</span><br><span class="line">				<span class="number">5'b10101</span>: encoder526 = <span class="number">6'b101010</span>;</span><br><span class="line">				<span class="number">5'b10110</span>: encoder526 = <span class="number">6'b011010</span>;</span><br><span class="line">				<span class="number">5'b10111</span>: encoder526 = <span class="number">6'b000101</span>;</span><br><span class="line">				<span class="number">5'b11000</span>: encoder526 = <span class="number">6'b001100</span>;</span><br><span class="line">				<span class="number">5'b11001</span>: encoder526 = <span class="number">6'b100110</span>;</span><br><span class="line">				<span class="number">5'b11010</span>: encoder526 = <span class="number">6'b010110</span>;</span><br><span class="line">				<span class="number">5'b11011</span>: encoder526 = <span class="number">6'b001001</span>;</span><br><span class="line">				<span class="number">5'b11100</span>: encoder526 = <span class="number">6'b001110</span>;</span><br><span class="line">				<span class="number">5'b11101</span>: encoder526 = <span class="number">6'b010001</span>;</span><br><span class="line">				<span class="number">5'b11110</span>: encoder526 = <span class="number">6'b100001</span>;</span><br><span class="line">				<span class="number">5'b11111</span>: encoder526 = <span class="number">6'b010100</span>;</span><br><span class="line">			<span class="keyword">endcase</span></span><br><span class="line">	<span class="keyword">endfunction</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">function</span> [<span class="number">3</span>:<span class="number">0</span>] encoder324;</span><br><span class="line">		<span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] i_data324;</span><br><span class="line">		<span class="keyword">if</span> (rd_flag == <span class="number">0</span>)	</span><br><span class="line">			<span class="keyword">case</span> (i_data324)</span><br><span class="line">				<span class="number">3'b000</span>: encoder324 = <span class="number">4'b1011</span>;</span><br><span class="line">				<span class="number">3'b001</span>: encoder324 = <span class="number">4'b1001</span>;</span><br><span class="line">				<span class="number">3'b010</span>: encoder324 = <span class="number">4'b0101</span>;</span><br><span class="line">				<span class="number">3'b011</span>: encoder324 = <span class="number">4'b1100</span>;</span><br><span class="line">				<span class="number">3'b100</span>: encoder324 = <span class="number">4'b1101</span>;</span><br><span class="line">				<span class="number">3'b101</span>: encoder324 = <span class="number">4'b1010</span>;</span><br><span class="line">				<span class="number">3'b110</span>: encoder324 = <span class="number">4'b0110</span>;</span><br><span class="line">				<span class="number">3'b111</span>:</span><br><span class="line">					<span class="keyword">begin</span></span><br><span class="line">						<span class="keyword">if</span> (i_data[<span class="number">4</span>:<span class="number">0</span>] == <span class="number">5'd17</span> || i_data[<span class="number">4</span>:<span class="number">0</span>] == <span class="number">5'd18</span> || i_data[<span class="number">4</span>:<span class="number">0</span>] == <span class="number">5'd20</span>)</span><br><span class="line">							encoder324 = <span class="number">4'b0111</span>;</span><br><span class="line">						<span class="keyword">else</span></span><br><span class="line">							encoder324 = <span class="number">4'b1110</span>;</span><br><span class="line">					<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">endcase</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">case</span> (i_data324)</span><br><span class="line">				<span class="number">3'b000</span>: encoder324 = <span class="number">4'b0100</span>;</span><br><span class="line">				<span class="number">3'b001</span>: encoder324 = <span class="number">4'b1001</span>;</span><br><span class="line">				<span class="number">3'b010</span>: encoder324 = <span class="number">4'b0101</span>;</span><br><span class="line">				<span class="number">3'b011</span>: encoder324 = <span class="number">4'b0011</span>;</span><br><span class="line">				<span class="number">3'b100</span>: encoder324 = <span class="number">4'b0010</span>;</span><br><span class="line">				<span class="number">3'b101</span>: encoder324 = <span class="number">4'b1010</span>;</span><br><span class="line">				<span class="number">3'b110</span>: encoder324 = <span class="number">4'b0110</span>;</span><br><span class="line">				<span class="number">3'b111</span>:</span><br><span class="line">					<span class="keyword">begin</span></span><br><span class="line">						<span class="keyword">if</span> (i_data[<span class="number">4</span>:<span class="number">0</span>] == <span class="number">5'd11</span> || i_data[<span class="number">4</span>:<span class="number">0</span>] == <span class="number">5'd13</span> || i_data[<span class="number">4</span>:<span class="number">0</span>] == <span class="number">5'd14</span>)</span><br><span class="line">							encoder324 = <span class="number">4'b1000</span>;</span><br><span class="line">						<span class="keyword">else</span></span><br><span class="line">							encoder324 = <span class="number">4'b0001</span>;</span><br><span class="line">					<span class="keyword">end</span></span><br><span class="line">			<span class="keyword">endcase</span></span><br><span class="line">	<span class="keyword">endfunction</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">function</span> [<span class="number">9</span>:<span class="number">0</span>] kencoder;</span><br><span class="line">	   <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] i_data;</span><br><span class="line">	   <span class="keyword">if</span> (rd_flag == <span class="number">0</span>)</span><br><span class="line">	       <span class="keyword">begin</span></span><br><span class="line">	           <span class="keyword">case</span> (i_data)</span><br><span class="line">	               <span class="number">8'b00011100</span>: kencoder = <span class="number">10'b0011110100</span>;</span><br><span class="line">	               <span class="number">8'b00111100</span>: kencoder = <span class="number">10'b0011111001</span>;</span><br><span class="line">	               <span class="number">8'b01011100</span>: kencoder = <span class="number">10'b0011110101</span>;</span><br><span class="line">	               <span class="number">8'b01111100</span>: kencoder = <span class="number">10'b0011110011</span>;</span><br><span class="line">	               <span class="number">8'b10011100</span>: kencoder = <span class="number">10'b0011110010</span>;</span><br><span class="line">	               <span class="number">8'b10111100</span>: kencoder = <span class="number">10'b0011111010</span>;</span><br><span class="line">	               <span class="number">8'b11011100</span>: kencoder = <span class="number">10'b0011110110</span>;</span><br><span class="line">	               <span class="number">8'b11111100</span>: kencoder = <span class="number">10'b0011111000</span>;</span><br><span class="line">	               <span class="number">8'b11110111</span>: kencoder = <span class="number">10'b1110101000</span>;</span><br><span class="line">	               <span class="number">8'b11111011</span>: kencoder = <span class="number">10'b1101101000</span>;</span><br><span class="line">	               <span class="number">8'b11111101</span>: kencoder = <span class="number">10'b1011101000</span>;</span><br><span class="line">	               <span class="number">8'b11111110</span>: kencoder = <span class="number">10'b0111101000</span>;</span><br><span class="line">	           <span class="keyword">endcase</span></span><br><span class="line">	       <span class="keyword">end</span></span><br><span class="line">	   <span class="keyword">else</span></span><br><span class="line">	       <span class="keyword">begin</span></span><br><span class="line">	           <span class="keyword">case</span> (i_data)</span><br><span class="line">	               <span class="number">8'b00011100</span>: kencoder = <span class="number">10'b1100001011</span>;</span><br><span class="line">	               <span class="number">8'b00111100</span>: kencoder = <span class="number">10'b1100000110</span>;</span><br><span class="line">	               <span class="number">8'b01011100</span>: kencoder = <span class="number">10'b1100001010</span>;</span><br><span class="line">	               <span class="number">8'b01111100</span>: kencoder = <span class="number">10'b1100001100</span>;</span><br><span class="line">	               <span class="number">8'b10011100</span>: kencoder = <span class="number">10'b1100001101</span>;</span><br><span class="line">	               <span class="number">8'b10111100</span>: kencoder = <span class="number">10'b1100000101</span>;</span><br><span class="line">	               <span class="number">8'b11011100</span>: kencoder = <span class="number">10'b1100001001</span>;</span><br><span class="line">	               <span class="number">8'b11111100</span>: kencoder = <span class="number">10'b1100000111</span>;</span><br><span class="line">	               <span class="number">8'b11110111</span>: kencoder = <span class="number">10'b0001010111</span>;</span><br><span class="line">	               <span class="number">8'b11111011</span>: kencoder = <span class="number">10'b0010010111</span>;</span><br><span class="line">	               <span class="number">8'b11111101</span>: kencoder = <span class="number">10'b0100010111</span>;</span><br><span class="line">	               <span class="number">8'b11111110</span>: kencoder = <span class="number">10'b1000010111</span>;	               </span><br><span class="line">	           <span class="keyword">endcase</span></span><br><span class="line">	       <span class="keyword">end</span></span><br><span class="line">	<span class="keyword">endfunction</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>然后编写 testbench 进行仿真</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">// Company: </span></span><br><span class="line"><span class="comment">// Engineer: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Create Date: 2018/12/13 17:54:13</span></span><br><span class="line"><span class="comment">// Design Name: </span></span><br><span class="line"><span class="comment">// Module Name: tb</span></span><br><span class="line"><span class="comment">// Project Name: </span></span><br><span class="line"><span class="comment">// Target Devices: </span></span><br><span class="line"><span class="comment">// Tool Versions: </span></span><br><span class="line"><span class="comment">// Description: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Dependencies: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Revision:</span></span><br><span class="line"><span class="comment">// Revision 0.01 - File Created</span></span><br><span class="line"><span class="comment">// Additional Comments:</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> tb(</span><br><span class="line"></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] i_data = <span class="number">8'hbc</span>;</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">9</span>:<span class="number">0</span>] o_data;</span><br><span class="line">    <span class="keyword">reg</span> clk = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">always</span> clk = #<span class="number">0</span><span class="variable">.5</span> ~clk;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] cnt = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">integer</span> fp_r;</span><br><span class="line">    <span class="keyword">integer</span> fp_w;</span><br><span class="line">    <span class="keyword">integer</span> count;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">initial</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">            count = <span class="number">0</span>;</span><br><span class="line">            fp_r = <span class="built_in">$fopen</span>(<span class="string">"D:/Mine/FPGA/data.txt"</span>, <span class="string">"r"</span>); <span class="comment">//这一行的地址为你刚刚生成的 data.txt 的地址</span></span><br><span class="line">            fp_w = <span class="built_in">$fopen</span>(<span class="string">"D:/Mine/FPGA/after_code.txt"</span>, <span class="string">"w"</span>); <span class="comment">//这一行的地址为编码后文件 after_code.txt 的输出地址</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (cnt != <span class="number">500</span>)</span><br><span class="line">                cnt &lt;= cnt + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">begin</span></span><br><span class="line">                    <span class="built_in">$fscanf</span>(fp_r, <span class="string">"%d"</span>, i_data);</span><br><span class="line">                    <span class="keyword">if</span> (count != <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">$fwrite</span>(fp_w, <span class="string">"%d\n"</span>, o_data);</span><br><span class="line">                    cnt &lt;= <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">if</span> (count != <span class="number">83702</span>) <span class="comment">//这个地方的数字改为你生成的 data.txt 文件里数据的个数</span></span><br><span class="line">                        count &lt;= count + <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            <span class="built_in">$fclose</span>(fp_r);</span><br><span class="line">                            <span class="built_in">$fclose</span>(fp_w);</span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    top test(</span><br><span class="line">        <span class="variable">.clk</span>(clk),</span><br><span class="line">        <span class="variable">.data_i</span>(i_data),</span><br><span class="line">        <span class="variable">.data_o</span>(o_data)</span><br><span class="line">        );</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>仿真完成之后即可生成名为 after_code.txt 的编码之后的文件<br>哦，对了！要运行这个仿真的话需要改一些地方，要改的地方我写注释里了</p>
<h3 id="8b-10b-解码器"><a href="#8b-10b-解码器" class="headerlink" title="8b/10b 解码器"></a>8b/10b 解码器</h3><p>首先用 Verilog 实现解码器</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">// Company: </span></span><br><span class="line"><span class="comment">// Engineer: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Create Date: 2018/12/14 20:41:55</span></span><br><span class="line"><span class="comment">// Design Name: </span></span><br><span class="line"><span class="comment">// Module Name: decoder</span></span><br><span class="line"><span class="comment">// Project Name: </span></span><br><span class="line"><span class="comment">// Target Devices: </span></span><br><span class="line"><span class="comment">// Tool Versions: </span></span><br><span class="line"><span class="comment">// Description: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Dependencies: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Revision:</span></span><br><span class="line"><span class="comment">// Revision 0.01 - File Created</span></span><br><span class="line"><span class="comment">// Additional Comments:</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> decoder(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">9</span>:<span class="number">0</span>] data_i,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] data_o</span><br><span class="line">    );</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (data_i)</span><br><span class="line">                <span class="number">10'b0011110100</span>, <span class="number">10'b1100001011</span>: data_o &lt;= <span class="number">8'b00011100</span>;</span><br><span class="line">                <span class="number">10'b0011111001</span>, <span class="number">10'b1100000110</span>: data_o &lt;= <span class="number">8'b00111100</span>;</span><br><span class="line">                <span class="number">10'b0011110101</span>, <span class="number">10'b1100001010</span>: data_o &lt;= <span class="number">8'b01011100</span>;</span><br><span class="line">                <span class="number">10'b0011110011</span>, <span class="number">10'b1100001100</span>: data_o &lt;= <span class="number">8'b01111100</span>;</span><br><span class="line">                <span class="number">10'b0011110010</span>, <span class="number">10'b1100001101</span>: data_o &lt;= <span class="number">8'b10011100</span>;</span><br><span class="line">                <span class="number">10'b0011111010</span>, <span class="number">10'b1100000101</span>: data_o &lt;= <span class="number">8'b10111100</span>;</span><br><span class="line">                <span class="number">10'b0011110110</span>, <span class="number">10'b1100001001</span>: data_o &lt;= <span class="number">8'b11011100</span>;</span><br><span class="line">                <span class="number">10'b0011111000</span>, <span class="number">10'b1100000111</span>: data_o &lt;= <span class="number">8'b11111100</span>;</span><br><span class="line">                <span class="number">10'b1110101000</span>, <span class="number">10'b0001010111</span>: data_o &lt;= <span class="number">8'b11110111</span>;</span><br><span class="line">                <span class="number">10'b1101101000</span>, <span class="number">10'b0010010111</span>: data_o &lt;= <span class="number">8'b11111011</span>;</span><br><span class="line">                <span class="number">10'b1011101000</span>, <span class="number">10'b0100010111</span>: data_o &lt;= <span class="number">8'b11111101</span>;</span><br><span class="line">                <span class="number">10'b0111101000</span>, <span class="number">10'b1000010111</span>: data_o &lt;= <span class="number">8'b11111110</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        data_o[<span class="number">4</span>:<span class="number">0</span>] &lt;= func_625(data_i[<span class="number">9</span>:<span class="number">4</span>]);</span><br><span class="line">                        data_o[<span class="number">7</span>:<span class="number">5</span>] &lt;= func_423(data_i[<span class="number">3</span>:<span class="number">0</span>]);</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">function</span> [<span class="number">4</span>:<span class="number">0</span>] func_625;</span><br><span class="line">        <span class="keyword">input</span> [<span class="number">5</span>:<span class="number">0</span>] data_in;</span><br><span class="line">        <span class="keyword">case</span> (data_in)</span><br><span class="line">            <span class="number">6'b100111</span>, <span class="number">6'b011000</span>: func_625 = <span class="number">5'b00000</span>;</span><br><span class="line">            <span class="number">6'b011101</span>, <span class="number">6'b100010</span>: func_625 = <span class="number">5'b00001</span>;</span><br><span class="line">            <span class="number">6'b101101</span>, <span class="number">6'b010010</span>: func_625 = <span class="number">5'b00010</span>;</span><br><span class="line">            <span class="number">6'b110001</span>: func_625 = <span class="number">5'b00011</span>;</span><br><span class="line">            <span class="number">6'b110101</span>, <span class="number">6'b001010</span>: func_625 = <span class="number">5'b00100</span>;</span><br><span class="line">            <span class="number">6'b101001</span>: func_625 = <span class="number">5'b00101</span>;</span><br><span class="line">            <span class="number">6'b011001</span>: func_625 = <span class="number">5'b00110</span>;</span><br><span class="line">            <span class="number">6'b111000</span>, <span class="number">6'b000111</span>: func_625 = <span class="number">5'b00111</span>;</span><br><span class="line">            <span class="number">6'b111001</span>, <span class="number">6'b000110</span>: func_625 = <span class="number">5'b01000</span>;</span><br><span class="line">            <span class="number">6'b100101</span>: func_625 = <span class="number">5'b01001</span>;</span><br><span class="line">            <span class="number">6'b010101</span>: func_625 = <span class="number">5'b01010</span>;</span><br><span class="line">            <span class="number">6'b110100</span>: func_625 = <span class="number">5'b01011</span>;</span><br><span class="line">            <span class="number">6'b001101</span>: func_625 = <span class="number">5'b01100</span>;</span><br><span class="line">            <span class="number">6'b101100</span>: func_625 = <span class="number">5'b01101</span>;</span><br><span class="line">            <span class="number">6'b011100</span>: func_625 = <span class="number">5'b01110</span>;</span><br><span class="line">            <span class="number">6'b010111</span>, <span class="number">6'b101000</span>: func_625 = <span class="number">5'b01111</span>;</span><br><span class="line">            <span class="number">6'b011011</span>, <span class="number">6'b100100</span>: func_625 = <span class="number">5'b10000</span>;</span><br><span class="line">            <span class="number">6'b100011</span>: func_625 = <span class="number">5'b10001</span>;</span><br><span class="line">            <span class="number">6'b010011</span>: func_625 = <span class="number">5'b10010</span>;</span><br><span class="line">            <span class="number">6'b110010</span>: func_625 = <span class="number">5'b10011</span>;</span><br><span class="line">            <span class="number">6'b001011</span>: func_625 = <span class="number">5'b10100</span>;</span><br><span class="line">            <span class="number">6'b101010</span>: func_625 = <span class="number">5'b10101</span>;</span><br><span class="line">            <span class="number">6'b011010</span>: func_625 = <span class="number">5'b10110</span>;</span><br><span class="line">            <span class="number">6'b111010</span>, <span class="number">6'b000101</span>: func_625 = <span class="number">5'b10111</span>;</span><br><span class="line">            <span class="number">6'b110011</span>, <span class="number">6'b001100</span>: func_625 = <span class="number">5'b11000</span>;</span><br><span class="line">            <span class="number">6'b100110</span>: func_625 = <span class="number">5'b11001</span>;</span><br><span class="line">            <span class="number">6'b010110</span>: func_625 = <span class="number">5'b11010</span>;</span><br><span class="line">            <span class="number">6'b110110</span>, <span class="number">6'b001001</span>: func_625 = <span class="number">5'b11011</span>;</span><br><span class="line">            <span class="number">6'b001110</span>: func_625 = <span class="number">5'b11100</span>;</span><br><span class="line">            <span class="number">6'b101110</span>, <span class="number">6'b010001</span>: func_625 = <span class="number">5'b11101</span>;</span><br><span class="line">            <span class="number">6'b011110</span>, <span class="number">6'b100001</span>: func_625 = <span class="number">5'b11110</span>;</span><br><span class="line">            <span class="number">6'b101011</span>, <span class="number">6'b010100</span>: func_625 = <span class="number">5'b11111</span>;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">endfunction</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> [<span class="number">2</span>:<span class="number">0</span>] func_423;</span><br><span class="line">        <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] data_in;</span><br><span class="line">        <span class="keyword">case</span> (data_in)</span><br><span class="line">            <span class="number">4'b1011</span>, <span class="number">4'b0100</span>: func_423 = <span class="number">3'b000</span>;</span><br><span class="line">            <span class="number">4'b1001</span>: func_423 = <span class="number">3'b001</span>;</span><br><span class="line">            <span class="number">4'b0101</span>: func_423 = <span class="number">3'b010</span>;</span><br><span class="line">            <span class="number">4'b1100</span>, <span class="number">4'b0011</span>: func_423 = <span class="number">3'b011</span>;</span><br><span class="line">            <span class="number">4'b1101</span>, <span class="number">4'b0010</span>: func_423 = <span class="number">3'b100</span>;</span><br><span class="line">            <span class="number">4'b1010</span>: func_423 = <span class="number">3'b101</span>;</span><br><span class="line">            <span class="number">4'b0110</span>: func_423 = <span class="number">3'b110</span>;</span><br><span class="line">            <span class="number">4'b1110</span>, <span class="number">4'b0001</span>: func_423 = <span class="number">3'b111</span>;</span><br><span class="line">            <span class="number">4'b0111</span>, <span class="number">4'b1000</span>: func_423 = <span class="number">3'b111</span>;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">endfunction</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>然后编写 testbench 进行仿真</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">// Company: </span></span><br><span class="line"><span class="comment">// Engineer: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Create Date: 2018/12/14 20:42:10</span></span><br><span class="line"><span class="comment">// Design Name: </span></span><br><span class="line"><span class="comment">// Module Name: tb</span></span><br><span class="line"><span class="comment">// Project Name: </span></span><br><span class="line"><span class="comment">// Target Devices: </span></span><br><span class="line"><span class="comment">// Tool Versions: </span></span><br><span class="line"><span class="comment">// Description: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Dependencies: </span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Revision:</span></span><br><span class="line"><span class="comment">// Revision 0.01 - File Created</span></span><br><span class="line"><span class="comment">// Additional Comments:</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> tb(</span><br><span class="line"></span><br><span class="line">    );      </span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">9</span>:<span class="number">0</span>] data_i = <span class="number">10'b0</span>;</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] data_o;</span><br><span class="line">    <span class="keyword">reg</span> clk = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">always</span> clk = #<span class="number">0</span><span class="variable">.5</span> ~clk;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] cnt = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">integer</span> fp_r;</span><br><span class="line">    <span class="keyword">integer</span> fp_w;</span><br><span class="line">    <span class="keyword">integer</span> count;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">reg</span> clk2MHz = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">initial</span></span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">            fp_r = <span class="built_in">$fopen</span>(<span class="string">"D:/Mine/FPGA/after_code.txt"</span>, <span class="string">"r"</span>);<span class="comment">//这一行的地址为你刚刚生成的 after_code.txt 的地址</span></span><br><span class="line">            fp_w = <span class="built_in">$fopen</span>(<span class="string">"D:/Mine/FPGA/after_decode.txt"</span>, <span class="string">"w"</span>);<span class="comment">//这一行的地址为解码后文件 after_decode.txt 的输出地址</span></span><br><span class="line">            count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</span><br><span class="line">        <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (cnt != <span class="number">500</span>)</span><br><span class="line">                <span class="keyword">begin</span></span><br><span class="line">                    cnt &lt;= cnt + <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (count != <span class="number">0</span>)</span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            <span class="keyword">if</span> (cnt == <span class="number">250</span>)</span><br><span class="line">                                clk2MHz &lt;= ~clk2MHz;</span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">begin</span></span><br><span class="line">                    <span class="built_in">$fscanf</span>(fp_r, <span class="string">"%d"</span>, data_i);</span><br><span class="line">                    cnt &lt;= <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">if</span> (count != <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">$fwrite</span>(fp_w, <span class="string">"%d\n"</span>, data_o);</span><br><span class="line">                        clk2MHz &lt;= ~clk2MHz;</span><br><span class="line">                    <span class="keyword">if</span> (count != <span class="number">83702</span>)<span class="comment">//这个地方的数字改为你生成的 after_code.txt 文件里数据的个数</span></span><br><span class="line">                        count &lt;= count + <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        <span class="keyword">begin</span></span><br><span class="line">                            <span class="built_in">$fclose</span>(fp_r);</span><br><span class="line">                            <span class="built_in">$fclose</span>(fp_w);</span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    </span><br><span class="line">    decoder test(</span><br><span class="line">        <span class="variable">.clk</span>(clk2MHz),</span><br><span class="line">        <span class="variable">.data_i</span>(data_i),</span><br><span class="line">        <span class="variable">.data_o</span>(data_o)</span><br><span class="line">        );</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>emmmmm… 这个仿真同样也有需要改动的地方，就在注释那<br>仿真完成后即可得名为 after_decode.txt 的解码之后的文件，这个时候可以将 after_decode.txt 于 data.txt 进行比对，这两个文件的内容应该是一致的，然后就从 after_decode.txt 中恢复图片，这个地方仍用 C++ 和 OpenCV 实现，代码如下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// recover.cpp: 定义控制台应用程序的入口点。</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdafx.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"></span><br><span class="line"><span class="function">uchar <span class="title">getdata</span><span class="params">(fstream &amp;)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">fstream <span class="title">f</span><span class="params">(<span class="string">"after_decode.txt"</span>, ios::in)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> data;</span><br><span class="line">	<span class="keyword">int</span> data_pre;</span><br><span class="line">	<span class="keyword">int</span> rows, cols;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"这个地方不要输错了，不然图片恢复不了"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"输入图片的高度："</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; rows;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"输入图片的宽度："</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; cols;</span><br><span class="line">	<span class="function">Mat <span class="title">img</span><span class="params">(rows, cols, CV_8UC1)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rows; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cols; ++j)</span><br><span class="line">		&#123;</span><br><span class="line">			img.at&lt;uchar&gt;(i, j) = getdata(f);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	imshow(<span class="string">"img"</span>, img);</span><br><span class="line">	imwrite(<span class="string">"result.jpg"</span>, img);</span><br><span class="line">	waitKey(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">uchar <span class="title">getdata</span><span class="params">(fstream &amp;f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> data_cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> val;</span><br><span class="line">	<span class="keyword">if</span> (data_cnt == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			f &gt;&gt; val;</span><br><span class="line">			<span class="keyword">if</span> (val == <span class="number">253</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	f &gt;&gt; val;</span><br><span class="line">	++data_cnt;</span><br><span class="line">	<span class="keyword">if</span> (data_cnt == <span class="number">64</span>)</span><br><span class="line">		data_cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> uchar(val);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行之后就可以看到你之前的图片了</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/08/随机变量及其分布/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="sjinglong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木头">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/08/随机变量及其分布/" itemprop="url">随机变量及其分布</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-08T13:21:29+08:00">
                2019-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="离散型"><a href="#离散型" class="headerlink" title="离散型"></a>离散型</h2><hr>
<h4 id="0-1-分布"><a href="#0-1-分布" class="headerlink" title="0 - 1 分布"></a>0 - 1 分布</h4><ul>
<li><strong>分布律</strong></li>
</ul>
<p>$$ P \lbrace x = k \rbrace = p^k (1-p)^{1-k}, (k = 0, 1; 0 &lt; p &lt; 1)$$</p>
<h4 id="二项分布"><a href="#二项分布" class="headerlink" title="二项分布"></a>二项分布</h4><ul>
<li><strong>分布律</strong> $ X \sim b(n, p) $</li>
</ul>
<p>$$ P \lbrace x = k \rbrace = C_n^k p^k(1-p)^{1-k}, (k = 0, 1, 2, \cdots) $$</p>
<h4 id="泊松分布"><a href="#泊松分布" class="headerlink" title="泊松分布"></a>泊松分布</h4><ul>
<li><strong>分布律</strong> $ X \sim \pi(\lambda) $</li>
</ul>
<p>$$ P \lbrace x = k \rbrace = \cfrac{\lambda^ke^{-\lambda}}{k!}, (k = 0, 1, 2, \cdots; \lambda &gt; 0) $$</p>
<ul>
<li><strong>泊松定理</strong></li>
</ul>
<p>设 $ \lambda &gt; 0 $ 是一个常数，$ n $ 是任意正整数，设 $ np_n = \lambda $，则对于任一固定的非负整数 $ k $，有</p>
<p>$$ \lim_{n \to \infty} C_n^k p_n^k (1-p_n)^{n-k} = \cfrac{\lambda^k e^{-\lambda}}{k!} $$</p>
<p>证：</p>
<p>由 $ n p_n = \lambda $ 可得 $ p_n = \cfrac{\lambda}{n} $<br>所以<br>$$<br>C_n^k p_n^k (1-p_n)^{n-k}  = \cfrac{n \cdot (n-1) \cdot (n-2) \cdots (n-k+1)}{k!}(\cfrac{\lambda}{n})^k(1 - \cfrac{\lambda}{n})^{n-k}<br>$$</p>
<p>$$<br>= \cfrac{\lambda^k}{k!}[1 \cdot (1-\cfrac{1}{n}) \cdot (1 - \cfrac{2}{n}) \cdots(1 - \cfrac{k-1}{n})] (1-\cfrac{\lambda}{n})^n(1-\cfrac{\lambda}{n})^{-k}<br>$$</p>
<p>所以</p>
<p>$$<br>\lim_{n\to\infty}C_n^kp_n^k(1-p_n)^{n-k}=\cfrac{\lambda^k}{k!}\cdot1\cdot e^{-\lambda} \cdot 1 = \cfrac{\lambda^ke^{-\lambda}}{k!}<br>$$</p>
<p>这说明以 $ n $, $ p $ 为参数的二项分布的概率值可以用参数为 $ \lambda = np $ 的泊松分布近似</p>
<h2 id="连续型"><a href="#连续型" class="headerlink" title="连续型"></a>连续型</h2><hr>
<h4 id="均匀分布"><a href="#均匀分布" class="headerlink" title="均匀分布"></a>均匀分布</h4><ul>
<li><strong>概率密度函数</strong> $ X \sim U(a,b) $</li>
</ul>
<p>$$<br>f(x)=<br>\begin{cases}<br>\cfrac{1}{b-a},&amp;b&gt;x&gt;a \<br>0,&amp;otherwise<br>\end{cases}<br>$$</p>
<h4 id="指数分布"><a href="#指数分布" class="headerlink" title="指数分布"></a>指数分布</h4><ul>
<li><strong>概率密度函数</strong></li>
</ul>
<p>$$<br>f(x)=<br>\begin{cases}<br>\cfrac{1}{\theta} e^{-\frac{x}{\theta}},&amp;x&gt;0 \<br>0,&amp;otherwise<br>\end{cases}<br>$$</p>
<ul>
<li><strong>性质</strong></li>
</ul>
<p><strong>无记忆性：</strong><br>$$<br>P\lbrace X &gt; s + t | X &gt; s \rbrace = P\lbrace X &gt; t \rbrace<br>$$</p>
<p>证：</p>
<p>$$<br>P\lbrace X &gt; s + t | X &gt; s \rbrace = \cfrac{P\lbrace (X &gt; s + t) \bigcap (X &gt; s) \rbrace}{P\lbrace X &gt; s \rbrace }<br>$$</p>
<p>$$<br>= \cfrac{P\lbrace X &gt; s + t \rbrace}{P\lbrace X &gt; s \rbrace }<br>$$</p>
<p>$$<br>= \cfrac{1-F(s+t)}{1-F(s)}<br>$$</p>
<p>$$<br>= \cfrac{e^{-(s+t)/\theta}}{e^{-s/\theta}}<br>$$</p>
<p>$$<br>= e^{-t/\theta}<br>$$</p>
<p>$$<br>= P\lbrace X &gt; t \rbrace<br>$$</p>
<h4 id="正态分布"><a href="#正态分布" class="headerlink" title="正态分布"></a>正态分布</h4><ul>
<li><strong>概率密度函数</strong> $ X \sim N(\mu, \sigma^2) $</li>
</ul>
<p>$$<br>f(x) = \cfrac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}, -\infty &lt; x &lt; \infty<br>$$</p>
<ul>
<li><strong>对概率密度函数的积分</strong></li>
</ul>
<p>令 $ t = \cfrac{x-\mu}{\sigma} $, 则有</p>
<p>$$<br>\int_{-\infty}^{\infty}\cfrac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}} \mathrm{d}x = \cfrac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\frac{t^2}{2}} \mathrm{d}t<br>$$</p>
<p>令 $ I =  \int_{-\infty}^{\infty}e^{-\frac{t^2}{2}} \mathrm{d}t $, 则有</p>
<p>$$<br>I^2 = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty} e^{-\frac{t^2+u^2}{2}}\mathrm{d}t\mathrm{d}u<br>$$</p>
<p>化为极坐标</p>
<p>$$<br>I^2 = \int_0^{2\pi} \int_0^\infty e^{-\frac{r^2}{2}}r\mathrm{d}r\mathrm{d}\theta = 2\pi<br>$$</p>
<p>由于 $ I &gt; 0 $, 所以 $ I = \sqrt{2\pi} $</p>
<p>所以</p>
<p>$$<br>\int_{-\infty}^{\infty}\cfrac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}} \mathrm{d}x = 1<br>$$</p>
<ul>
<li><strong>概率密度函数的拐点</strong></li>
</ul>
<p>对概率密度函数求二阶导, 可得</p>
<p>$$<br>f^{\prime\prime}(x) = \cfrac{-1}{\sqrt{2\pi}\sigma^3}[1-\cfrac{(x-\mu)^2}{\sigma^2}]e^{-\frac{(x-\mu)^2}{2\sigma^2}}<br>$$</p>
<p>可以看出，当 $x = \mu \pm \sigma $ 时， $ f^{\prime\prime}(x) = 0 $<br>即在 $ x = \mu \pm \sigma $ 处，曲线有拐点</p>
<h2 id="随机变量的函数"><a href="#随机变量的函数" class="headerlink" title="随机变量的函数"></a>随机变量的函数</h2><hr>
<p>设随机变量 $ X $ 具有概率密度 $ f_X(x), \infty&gt;x&gt;-\infty $，又设 $ g(x) $ 处处可导且恒有 $ g^\prime(x)&gt;0 $ （ 或恒有 $ g^\prime(x)&lt;0 $ ），则 $ Y=g(X) $ 是连续型随机变量，其概率密度为</p>
<p>$$<br>f_Y(y)=<br>\begin{cases}<br>f_X[h(y)]|h^\prime(y)|, &amp;\beta &gt; y &gt; \alpha\<br>0, &amp;otherwise<br>\end{cases}<br>$$</p>
<p>其中 $ \alpha = min \lbrace g(-\infty),g(\infty) \rbrace $ ， $ \beta = max \lbrace g(-\infty),g(\infty) \rbrace $ ， $ h(y) $ 是 $ g(x) $ 的反函数.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/08/关于学习音乐的一个重要问题-练耳/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="sjinglong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木头">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/08/关于学习音乐的一个重要问题-练耳/" itemprop="url">关于学习音乐的一个重要问题--练耳</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-08T13:12:06+08:00">
                2019-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>这篇文章是徐大大大大大大清写的，我觉得很有用</p>
</blockquote>
<h3 id="我的问题究竟在哪里？"><a href="#我的问题究竟在哪里？" class="headerlink" title="我的问题究竟在哪里？"></a>我的问题究竟在哪里？</h3><p>许多同学存在这样的疑问：</p>
<p>弹琴是不是一定要找谱子？为什么有的人一听就能弹出来？这是不是境界非常高，或者天赋异禀？我也可以做到吗？</p>
<p>为什么有的人听一听就知道歌曲的和弦？</p>
<p>为什么我好像练了一些东西，但还是没法跟着伴奏做简单的即兴？</p>
<p>为什么我辛辛苦苦学了这么多乐理却好像没什么用？</p>
<p>这些问题都来自于一个环节的缺陷：练耳</p>
<p>练耳：即训练听力，即训练对听到的音乐事件的辨识力，即听到某音乐事件后能迅速准确地反映或描述的能力。</p>
<p>说白了，就是你听到一个旋律，或者和弦进行，或者节奏，你就知道它其中的具体内容，到底是哪几个音，哪几个和弦，哪种节奏型。</p>
<p>你可能会发问：这不是专业学音乐的才学的东西吗？而且听起来就很难很神秘，不是一般人能做到的啊，普通人学乐器需要学这个吗？</p>
<p>这样的想法非常普遍，可以理解，但是它不对。辨识音乐事件的能力很少人有，但是这不是因为它难，而是因为目前大部分的音乐培训机构，上课的主要内容就是乐器演奏技术和对着谱子练习，却不重视练耳，甚至不教乐理。这其实是非常错误的，但是似乎少有人知道。</p>
<h3 id="学习音乐的正确观念"><a href="#学习音乐的正确观念" class="headerlink" title="学习音乐的正确观念"></a>学习音乐的正确观念</h3><p>学习音乐，学习乐器的基本观点应该是：学乐器/音乐，先学乐理。学乐理，先练听力。学音乐最重要的不是喉咙，不是手指，甚至不是大脑，而是耳朵，或者说耳朵和大脑思维的结合。</p>
<p>没有乐理知识的支撑，弹琴基本等于单纯的手指运动，枯燥而低效，想弹一个曲子，只能到处找乐谱。而没有听力作为基础，乐理就是无用的知识，以文字的形式存在于你的脑海中，你听不到你学的知识，更无从运用。你永远无法真正理解你所听到和演奏的东西。</p>
<p>比方说，我今天学了一个C自然大调音阶，我会在吉他上把它弹出来，但是我却无法脱离吉他判断我正在弹的是哪一个音。我学了一个C和弦，我甚至知道C和弦是哪几个音组成的，他们的关系是怎样，但是我却回忆不起来它听起来确切是什么样的。我学了一首曲子，弹的很完美，但是过了几个月不练，我又忘记我的左手应该按到第几品，右手弹哪根弦了。</p>
<p>这样有什么意义呢？我似乎学会了如何演奏它，甚至知道它其中的确切关系，物理规律，但是在我却不能准确地回忆起它听起来是什么感觉，更无法在听到的音乐中辨识它，更无从在创造中运用它。</p>
<p>但是，如果我重视听力，平时有意识地练耳，我学习了一个音阶，就不仅仅是知道怎么把它从低到高弹出来，而是把每一个音高的具体位置记在脑海中。这样，当我听到一段旋律，甚至和弦等等，我就能辨识出它是哪些音，并且运用我的乐器把它再现，而不需要去找乐谱，这该多好！</p>
<p>你可能会想：这对我来说太难了，似乎不可能做到。但我要说的是，这不是因为你做不到，而是因为你没有练习听力的意识！不是做不到，而是没有意识。只要你有这个意识，以正确的方法练习，想要收获进步，获得听音的能力，并不是你想的那么难。</p>
<h3 id="听音究竟是怎么回事？"><a href="#听音究竟是怎么回事？" class="headerlink" title="听音究竟是怎么回事？"></a>听音究竟是怎么回事？</h3><p>首先让我们再次回顾刚刚提到的“听了一下就能弹出来”究竟是怎么一回事：第一步是听音，辨识出听到的音乐里的音乐事件（音，节奏，和声等等）并且记住。第二步是把听到的音弹出来，这就运用了乐器演奏技术的知识。显而易见的是，第一步是我们的重点所在，是我们想要获得的能力。这么说你可能还是有点迷糊，我怎么才听得出来呢？</p>
<p>那我们就要再说得细一点，把听音的过程再拆分：“辨识”，其实就是认出来你熟悉的东西，好比我已经认识我的一个朋友，他叫张三，那么我看到他的时候我才能叫他张三。如果我压根不认识他，我看到他的时候怎么能叫他张三？听力也是一样，只有你已经熟悉了这个音听起来是什么感觉，听到它的时候才能辨认出来。这么一说，相信你应该明白了：练耳，其实就是把你想要辨认的事件拿出来，一遍遍地记忆，熟悉它，这样当你听到它，你就能认出它。</p>
<p>这就是所谓的听音能力，本质上是一种记忆，而不是听力。</p>
<p>是不是很清楚了？这样一来，练习的方法也很明显了：那就是通过各种方式熟悉各种音乐事件。</p>
<h3 id="具体一点，我该怎么练习？"><a href="#具体一点，我该怎么练习？" class="headerlink" title="具体一点，我该怎么练习？"></a>具体一点，我该怎么练习？</h3><p>让我们从最基础的音级练习开始：所有刚开始学乐器或者从来没有过听力练习的学习者都应该做这样的练习。</p>
<p>现在你拥有一个自然大调音阶，do，re，mi，fa，sol，la，ti。不管你使用钢琴，吉他，或者手机上的数码钢琴，以及任何能发出正确的音高的乐器演奏出来都可以，先从低到高弹几遍，让它在你的脑海中有个大概的印象。</p>
<p>然后我们就可以开始了：</p>
<ol>
<li><p>从re开始，先弹一个re，一边弹，一边“模唱”，也就是模仿它的音高唱，让你的音调接近你弹出来的音直到重合，即使不好听也不要紧，轻轻哼一下也可以，只要音调一样。好，你做到了，非常不错！</p>
</li>
<li><p>再弹一下do，集中注意力记忆你刚刚弹和唱的re相对于do是什么样的感觉，它的具体高度是怎样的。没错！我们并不是记忆“单个的音”，而是记忆它相对于do的位置！因为所有的音都是以它为中心和参照的。然后重复这个过程，直到你认为自己记住了为止。</p>
</li>
</ol>
<p>后面的mi, fa, sol等等，也是用一样的方法去练习！</p>
<p>归纳起来就是模唱和记忆这简单的两步，是不是非常容易呢？这就是最基本的练习方法：刻意熟悉，或者叫刻意记忆。</p>
<h3 id="构唱"><a href="#构唱" class="headerlink" title="构唱"></a>构唱</h3><p>在完成一个音的记忆以后，你可以给自己“听写”一下来巩固，就像记单词一样，你认为自己记住了，但是到了听写的时候，脱离了单词本，你可能会发现你并没有记得很牢固。所以我们一定要脱离乐器，“默写”这个音，才能达到记忆的效果。</p>
<p>业内人士称之为“构唱”，构造的构，什么意思呢？比如我先出一个题：唱do-fa，所谓构就是自己构造事件，我是已经知道了要唱的音，再唱出来，注意要直接唱，中间不要经过其他的音。刚开始唱可能会有点吃力，毕竟不是那么熟悉，你可以借助乐器弹奏出来，校准你唱的音调。</p>
<p>是不是很简单呢？就像记单词一样，先照着单词写，重复一下，再自己回想着写出来。不同的只是单词可以理性地用音节来拆分，但是音级是凭感性思维去感受和记忆的。</p>
<p>其他内容也是一样！自然小调（别忘了你刚刚只是练了大调！），节奏，音程，和弦等等，都可以用同样的理念和方法来练习，总之围绕“熟悉”去练习、记忆！学了什么就应该听什么，记什么！</p>
<h3 id="其他有趣而必要的方法"><a href="#其他有趣而必要的方法" class="headerlink" title="其他有趣而必要的方法"></a>其他有趣而必要的方法</h3><p>一直重复刚刚的练习一定会让你感到枯燥无味，不想继续练了，而且只做上面的练习也不能保证实用性，所以我们需要一些有趣的补充练习来丰富我们的练习内容，保持练习的趣味性，动力和有效性。</p>
<h4 id="重复已知事件：唱你喜欢的歌！"><a href="#重复已知事件：唱你喜欢的歌！" class="headerlink" title="重复已知事件：唱你喜欢的歌！"></a>重复已知事件：唱你喜欢的歌！</h4><p>找出你学过的儿歌，两只老虎，小星星，或者是你喜欢的歌曲或器乐作品的简谱，最好是简单好唱的，用唱名（do re mi等等）唱出来，并记忆每一个音高，重复这个过程，加深印象；最好用乐器同步弹奏，保证你记忆的音是准确的。</p>
<p>这样练习的优点是比基础的模唱和构唱更有趣，同时也达到了记忆的目的，平时没事就可以唱唱，轻松记忆。</p>
<h4 id="扒带（听辨）实践：自己找音！"><a href="#扒带（听辨）实践：自己找音！" class="headerlink" title="扒带（听辨）实践：自己找音！"></a>扒带（听辨）实践：自己找音！</h4><p>扒带，即辨识你在音乐作品中听到的音乐事件，比如听到一个旋律然后辨识其中的音，听到一个和声进行辨识其中的和弦等等。这是理解音乐需要的最基本能力，非常重要。这也是我们练耳的最终目的。</p>
<p>实际上，扒带本身并不能让你取得进步，但是它可以辅助你的进步，让你的练习更有方向性和趣味性。第一次不借助乐谱弹奏出自己喜欢的音乐的感觉简直无与伦比，伙计！</p>
<p>是的！即使是初学者也可以尝试着扒带。不过还是建议有一点音级和歌曲的积累，脑中有一个自然大小调的音阶体系以后开始，这样你更容易感觉出do的位置，否则你必须先通过其他方式知道它是哪一个调的音乐。</p>
<p>具体怎么扒带呢？首先我们要知道我们要辨识的是哪一个音，对于初学者来说，可能第一个音就很难直接听出来，那么我们就从第一个音开始：</p>
<p>听一下这个音，然后马上按下暂停！后面的音很可能干扰你对这个音的印象。然后模唱这个音，把它拉长，以加深它在你脑中的印象，防止忘记。好了，现在你已经牢牢记住了这个音的感觉。感受一下它在do的上方还是下方。</p>
<p>从do（调式主音，小调就从la）开始，一级一级地递推，比如往上，re, mi, fa, sol…la！感觉和刚刚那个音一样！那么恭喜你，你已经找到了这个音是什么，后面的音也是同样的方法！</p>
<p>刚刚我们说了，扒带本身也许并不能让你在听力上进步，也就是更熟悉某个音，但是却可以提醒你，这个音，或者这几个音组合起来的感觉，你还不够熟悉，这样你就可以有针对性地练习你的弱势（你也可以把它当做一个练习效果的小测验，让你看到你的进步）； </p>
<p>另外，它能告诉你音乐作品里会用到哪些音（事件），哪些不会用到，这样你就不会去记忆一些根本不需要的音，让你练得更有方向性！你也不需要再去到处找乐谱了！所以扒带的好处是非常多的。</p>
<p>想想看，听辨大师的作品，就像和大师对话，尝试理解他的思维，这是一件非常美好而有趣的事，不是吗？</p>
<h3 id="练习的合理安排"><a href="#练习的合理安排" class="headerlink" title="练习的合理安排"></a>练习的合理安排</h3><p>就像背单词一样，记忆音高或是节奏也需要合理安排时间，不要一次性练习太多内容，记忆是有限的，注重日积月累！大脑也需要休息。如果每天练习四十分钟，那你可以把它拆分成两个二十分钟，也可以穿插练习不同的东西来放松一下。</p>
<p>另外，和背单词一样，如果不复习就会忘记，所以不要忘记复习你昨天和前天练习的内容，常常巩固一下！你可以利用歌曲或者器乐作品来重复你已经建立的印象，巩固记忆。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/08/minAreaRect函数返回值说明/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="sjinglong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木头">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/08/minAreaRect函数返回值说明/" itemprop="url">minAreaRect函数返回值说明</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-08T13:08:33+08:00">
                2019-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>最近在看代码的时候发现 OpenCV 里面 minAreaRect() 这个函数返回的旋转矩形的 angle, height, width 有点让人困惑，不清楚为什么它们的值是那么多，网上找的解释竟然解释的还不一样，于是就自己写代码验证了一下，我也不知道对不对，欢迎评论指正</p>
</blockquote>
<h3 id="先放几张测试图片"><a href="#先放几张测试图片" class="headerlink" title="先放几张测试图片"></a>先放几张测试图片</h3><p><img src="http://i350.photobucket.com/albums/q439/wood_/1_zpszzciuets.jpg" alt="1.jpg"></p>
<p><img src="http://i350.photobucket.com/albums/q439/wood_/2_zpsmwe577ot.jpg" alt="2.jpg"></p>
<p><img src="http://i350.photobucket.com/albums/q439/wood_/3_zpsmic8iuin.jpg" alt="3.jpg"></p>
<p><img src="http://i350.photobucket.com/albums/q439/wood_/4_zpsiwk22nzz.jpg?t=1538449392" alt="4.jpg"></p>
<h3 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h3><p>其实从图片上看，结果已经很明确了，minAreaRect() 返回的旋转矩形有如下特征</p>
<ul>
<li><p>angle = 过旋转矩形中心的直线(绿线)逆时针旋转，当它第一次与旋转矩形的边垂直时，该直线旋转过的角度的相反数即为 angle 的值</p>
</li>
<li><p>width = 与旋转直线(绿线)第一次垂直的那两条边的长度，即为 width 的值</p>
</li>
<li><p>height = 不是 width 的那两条边的长度，即为 height 的值咯</p>
</li>
</ul>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Mat <span class="title">img</span><span class="params">(<span class="number">500</span>, <span class="number">500</span>, CV_8UC3)</span></span>;</span><br><span class="line">    RNG &amp;rng = theRNG();</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> count = rng.uniform(<span class="number">1</span>, <span class="number">101</span>);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Point2f&gt; points;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; ++i) &#123;</span><br><span class="line">            Point2f pt;</span><br><span class="line">            pt.x = rng.uniform(img.size().width / <span class="number">4</span>, img.size().width * <span class="number">3</span> / <span class="number">4</span>);</span><br><span class="line">            pt.y = rng.uniform(img.size().height / <span class="number">4</span>, img.size().height * <span class="number">3</span> / <span class="number">4</span>);</span><br><span class="line">            points.push_back(pt);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        RotatedRect rect = minAreaRect(Mat(points));</span><br><span class="line">        Point2f rectPoints[<span class="number">4</span>];</span><br><span class="line">        rect.points(rectPoints);</span><br><span class="line"></span><br><span class="line">        img = Scalar::all(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; ++i) &#123;</span><br><span class="line">            circle(img, points[i], <span class="number">3</span>, Scalar(<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), FILLED, LINE_AA);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            line(img, rectPoints[i], rectPoints[(<span class="number">1</span> + i) % <span class="number">4</span>], Scalar(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="number">3</span>, LINE_AA);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        line(img, Point2f(rect.center.x, <span class="number">0</span>), Point2f(rect.center.x, img.size().height), Scalar(<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>), <span class="number">2</span>, LINE_AA);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">char</span> text[<span class="number">50</span>];</span><br><span class="line">        <span class="built_in">sprintf</span>(text, <span class="string">"angle: %.2f, width: %.2f, height: %.2f"</span>, rect.angle, rect.size.width, rect.size.height);</span><br><span class="line">        putText(img, text, Point(<span class="number">2</span>, <span class="number">15</span>), CV_FONT_NORMAL, <span class="number">0.5</span>, Scalar(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>));</span><br><span class="line"></span><br><span class="line">        imshow(<span class="string">"img"</span>, img);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (waitKey(<span class="number">0</span>) == <span class="number">27</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/08/Ubuntu16-04LTS下编译安装OpenCV/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="sjinglong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木头">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/08/Ubuntu16-04LTS下编译安装OpenCV/" itemprop="url">Ubuntu16.04LTS下编译安装OpenCV</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-08T13:05:45+08:00">
                2019-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Ubuntu16-04LTS下编译安装OpenCV"><a href="#Ubuntu16-04LTS下编译安装OpenCV" class="headerlink" title="Ubuntu16.04LTS下编译安装OpenCV"></a>Ubuntu16.04LTS下编译安装OpenCV</h1><blockquote>
<p>这篇教程是陈明聪学长写的，这里放在我的博客上供以后参考</p>
<p>添加了 OpenCV_Contrib 的编译安装</p>
</blockquote>
<h3 id="Pre-前期准备"><a href="#Pre-前期准备" class="headerlink" title="Pre.前期准备"></a>Pre.前期准备</h3><p>下载OpenCV 和 OpenCV_Contrib 源码包<br>进入<a href="https://opencv.org/releases.html" target="_blank" rel="noopener">OpenCV官方下载页面</a><br>选择Sources类型下载<br>OpenCV_Contrib 的源码去 Github 上找找，我也忘了我在哪下的了，下的版本要跟 OpenCV 一样…</p>
<h3 id="1-安装依赖包"><a href="#1-安装依赖包" class="headerlink" title="1.安装依赖包"></a>1.安装依赖包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install cmake</span><br><span class="line">sudo apt-get install build-essential libgtk2.0-dev libavcodec-dev libavformat-dev libjpeg.dev libtiff4.dev libswscale-dev libjasper-dev</span><br></pre></td></tr></table></figure>
<h3 id="2-编译OpenCV"><a href="#2-编译OpenCV" class="headerlink" title="2.编译OpenCV"></a>2.编译OpenCV</h3><p>解压之前下载好的源码包<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unzip opencv-3.4.3.zip  #这里以opencv-3.4.3为例</span><br><span class="line">unzip opencv_contrib-3.4.3.zip -d /opencv-3.4.3 #把 opencv_contrib 解压到 opencv 源码目录下</span><br></pre></td></tr></table></figure></p>
<p>进入OpenCV源码目录<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd opencv-3.4.3</span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake -D CMAKE_BUILD_TYPE=Release -D CMAKE_INSTALL_PREFIX=/usr/local -D OPENCV_EXTRA_MODULES_PATH=../opencv_contrib-3.4.3/modules ..</span><br><span class="line">sudo make -j4</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure></p>
<h3 id="3-添加路径"><a href="#3-添加路径" class="headerlink" title="3.添加路径"></a>3.添加路径</h3><p>首先将OpenCV的库添加到路径，从而可以让系统找到<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/ld.so.conf.d/opencv.conf</span><br></pre></td></tr></table></figure></p>
<p>执行此命令后打开的可能是一个空白文件，不用管，只用在文件末尾添加<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/lib</span><br></pre></td></tr></table></figure></p>
<p>执行如下命令使得刚才的配置路径生效<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure></p>
<p>配置bash<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/bash.bashrc</span><br></pre></td></tr></table></figure></p>
<p>在最末尾添加<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig</span><br><span class="line">export PKG_CONFIG_PATH</span><br></pre></td></tr></table></figure></p>
<p>保存，执行如下命令使得配置生效<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/bash.bashrc</span><br></pre></td></tr></table></figure></p>
<p>更新<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo updatedb</span><br></pre></td></tr></table></figure></p>
<h3 id="4-测试"><a href="#4-测试" class="headerlink" title="4.测试"></a>4.测试</h3><p>至此所有的配置都已经完成<br>下面用一个小程序测试一下<br>cd到opencv-3.4.3/samples/cpp/example_camke目录下<br>我们可以看到这个目录下官方已经给出了一个cmake的example我们可以拿来测试下<br>按顺序执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cmake .</span><br><span class="line">make</span><br><span class="line">./opencv_example</span><br></pre></td></tr></table></figure>
<p>即可看到打开了摄像头，在左上角有一个hello opencv，即表示配置成功</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/08/树莓派下编译安装OpenCV-3-4-1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="sjinglong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木头">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/08/树莓派下编译安装OpenCV-3-4-1/" itemprop="url">树莓派下编译安装OpenCV-3.4.1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-08T13:00:58+08:00">
                2019-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="树莓派下编译安装OpenCV-3-4-1"><a href="#树莓派下编译安装OpenCV-3-4-1" class="headerlink" title="树莓派下编译安装OpenCV-3.4.1"></a>树莓派下编译安装OpenCV-3.4.1</h3><hr>
<ol>
<li><strong>首先建议先更换软件源，这里以清华的源为例</strong></li>
</ol>
<ul>
<li><p>使用管理员权限，编辑/etc/apt/sources.list文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/apt/sources.list</span><br></pre></td></tr></table></figure>
</li>
<li><p>用#注释掉原文件的内容，用以下内容取代</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ stretch main contrib non-free rpi</span><br><span class="line">deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ stretch main contrib  non‐free rpi</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用管理员权限，编辑/etc/apt/sources.list.d/raspi.list</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/apt/sources.list.d/raspi.list</span><br></pre></td></tr></table></figure>
</li>
<li><p>用#注释掉原文件的内容，用以下内容取代</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirror.tuna.tsinghua.edu.cn/raspberrypi/ stretch main ui</span><br><span class="line">deb‐src http://mirror.tuna.tsinghua.edu.cn/raspberrypi/ stretch main ui</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新软件源列表</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="2">
<li><p><strong>为了充分使用整个存储空间，输入以下命令，进入到软件配置工具后，选择第七项 “Advanced Options” ，再选择 A1 项 “Expand Filesystem” 即可</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo raspi-config</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>先更新一下</strong></p>
<ul>
<li><p>软件源更新</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt‐get update</span><br></pre></td></tr></table></figure>
</li>
<li><p>升级本地所有安装包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt‐get upgrade</span><br></pre></td></tr></table></figure>
</li>
<li><p>升级树莓派固件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rpi‐update</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>安装构建OpenCV的相关工具</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt‐get install build‐essential cmake git pkg‐config</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>安装常用图像工具包</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>安装jpeg格式图像工具包 </span><br><span class="line">sudo apt‐get install libjpeg8‐dev</span><br><span class="line"><span class="meta">#</span>安装tif格式图像工具包 </span><br><span class="line">sudo apt‐get install libtiff5‐dev</span><br><span class="line"><span class="meta">#</span>安装JPEG‐2000格式图像工具包 </span><br><span class="line">sudo apt‐get install libjasper‐dev</span><br><span class="line"><span class="meta">#</span>安装png格式图像工具包 </span><br><span class="line">sudo apt‐get install libpng12‐dev</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>安装视频I/O包（注意最后一个包的数字“4”后面是“L”)</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt‐get install libavcodec‐dev libavformat‐dev libswscale‐dev libv4l‐dev</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>安装gtk2.0</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt‐get install libgtk2.0‐dev</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>安装优化函数包</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt‐get install libatlas‐base‐dev gfortran</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>下载OpenCV源码（放在家目录下）</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget ‐O opencv‐3.4.1.zip https://github.com/Itseez/opencv/archive/3.4.1.zip</span><br><span class="line">unzip opencv‐3.4.1.zip</span><br><span class="line">wget ‐O opencv_contrib‐3.4.1.zip  https://github.com/Itseez/opencv_contrib/archive/3.4.1.zip</span><br><span class="line">unzip opencv_contrib‐3.4.1.zip</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>进入源码文件夹，新建一个名为 release 的文件夹用来存放 cmake 编译时产生的临时文件</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd opencv-3.4.1</span><br><span class="line">mkdir release</span><br><span class="line">cd release</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>设置 cmake 编译参数，安装目录默认为 /usr/local , 注意参数名，等号和参数值之间不能有空格，但每行末尾 “\” 之前有空格，参数值最后是两个英文的点，如果cmake下载缺失文件失败的话，就将release文件夹删掉，从第十步重新开始</strong></p>
</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo cmake ‐D CMAKE_BUILD_TYPE=RELEASE \</span><br><span class="line">‐D CMAKE_INSTALL_PREFIX=/usr/local \</span><br><span class="line">‐D OPENCV_EXTRA_MODULES_PATH=~/opencv_contrib‐3.4.1/modules \</span><br><span class="line">‐D INSTALL_PYTHON_EXAMPLES=ON \</span><br><span class="line">‐D BUILD_EXAMPLES=ON ..</span><br></pre></td></tr></table></figure>
<ol start="12">
<li><p><strong>开始编译</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>编译</span><br><span class="line">sudo make</span><br><span class="line"><span class="meta">#</span>安装</span><br><span class="line">sudo make install</span><br><span class="line"><span class="meta">#</span>更新动态链接库</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编译安装完了应该就可以了，可以写个程序测试一下</strong></p>
</li>
</ol>
<hr>
<p>参考链接：</p>
<ul>
<li><a href="https://blog.csdn.net/jacka654321/article/details/80728795" target="_blank" rel="noopener">树莓派OpenCV3.4.1安装血泪史，分享如何规避各种坑</a></li>
<li><a href="https://blog.csdn.net/leaves_joe/article/details/67656340" target="_blank" rel="noopener">(树莓派、Linux通用)OpenCV3源码方式安装（最新3.4.1）</a></li>
<li><a href="https://blog.csdn.net/la9998372/article/details/77886806" target="_blank" rel="noopener">为树莓派更换国内镜像源</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/08/树莓派初次使用教程/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="sjinglong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木头">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/08/树莓派初次使用教程/" itemprop="url">树莓派初次使用教程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-08T12:43:57+08:00">
                2019-02-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="树莓派初次使用教程"><a href="#树莓派初次使用教程" class="headerlink" title="树莓派初次使用教程"></a>树莓派初次使用教程</h3><hr>
<blockquote>
<p>这个教程主要是针对你身边没有显示器，键盘等之类的情况，如果你有显示器，键盘等，就完全不用这么麻烦</p>
</blockquote>
<ol>
<li>准备材料：树莓派，网线一根，内存卡一张（建议最小16G），笔记本电脑 </li>
<li>去<a href="https://www.raspberrypi.org/downloads/" target="_blank" rel="noopener">树莓派官网</a>下载系统镜像，下raspbian就行 </li>
<li>下载<a href="https://sourceforge.net/projects/win32diskimager/" target="_blank" rel="noopener">Win32 Disk Imager</a>(烧写镜像的工具) </li>
<li>先格式化一下你的内存卡 </li>
<li><p>打开Win32 Disk Image, 在映像文件这一栏选择你刚才下载的镜像文件，再在设备中选择你的SD卡，点击写 入即可，<strong>写入后，在boot目录下新建一个名为ssh的空白文档，删掉.txt后缀</strong>。如果烧写失败，或者下一步中 启动树莓派时有问题，需要重新烧写系统时，<strong>你需要先将内存卡的分区合并，再进行烧写</strong>，合并分区的方法 如下 </p>
<ol>
<li>首先WIN+R，输入cmd进入Windows命令行 </li>
<li><p>输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DISKPART</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看机器磁盘，输入以下命令，根据磁盘大小可以判断SD卡是哪个磁盘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list disk</span><br></pre></td></tr></table></figure>
</li>
<li><p>假如我这里SD卡为磁盘1，则我就需要选中磁盘1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select disk 1</span><br></pre></td></tr></table></figure>
</li>
<li><p>输入clean删除磁盘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clean</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建主磁盘分区</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE PARTITION PRIMARY</span><br></pre></td></tr></table></figure>
</li>
<li><p>激活磁盘分区</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">active</span><br></pre></td></tr></table></figure>
</li>
<li><p>以FAT32格式快速格式化磁盘分区</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FORMAT FS=FAT32 QUICK</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>将内存卡插入树莓派，启动树莓派，并用网线与笔记本电脑相连</p>
</li>
<li>配置共享网络<ol>
<li>设置 -&gt; 网络和Internet -&gt; 状态 -&gt; 网络和共享中心 -&gt; WLAN -&gt; 属性 -&gt; 共享</li>
<li>勾选上“允许其他网络用户通过此计算机的Internet连接来连接”</li>
<li>在“家庭网络连接”下拉栏中选择“以太网”</li>
<li>点击确定</li>
</ol>
</li>
<li><p>查找树莓派IP<br>WIN+R输入cmd进入Windows的命令行，输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp -a</span><br></pre></td></tr></table></figure>
<p>查看网络IP，一般来说192.168.137.1下的就是树莓派的IP地址<br>如果你确实无法确定树莓派IP，就用以下办法 </p>
<ol>
<li>下载<a href="http://www.advanced-ip-scanner.com/cn/" target="_blank" rel="noopener">Advanced IP Scanner</a></li>
<li>设置好IP的扫描范围（我这用的是192.168.1.1 - 192.168.1.254, 192.168.137.1 - 192.168.137.254） 后，点击Scan</li>
<li>扫出来的结果中名称为raspberrypi的IP地址就是树莓派的IP地址 </li>
</ol>
</li>
<li>下载<a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html" target="_blank" rel="noopener">PuTTY</a></li>
<li>运行PuTTY，输入树莓派的IP，选择SSH连接，点击Open(会弹出一个警告，点击否就行)</li>
<li>输入用户名pi，和默认密码raspberry登陆即可，输入密码的时候没有回显</li>
<li><p>登陆后，输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd root</span><br></pre></td></tr></table></figure>
<p>开启root账户（会让你设置root的密码）</p>
</li>
<li><p>输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<p>更新一下 </p>
</li>
<li><p>安装tightvncserver</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt‐get install tightvncserver</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装xrdp服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt‐get install xrdp</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装服务包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt‐get install vnc4server</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动xrdp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/xrdp start</span><br></pre></td></tr></table></figure>
</li>
<li><p>WIN+R输入mstsc，进入远程桌面连接</p>
</li>
<li>输入树莓派IP，点击连接</li>
<li>选Xvnc或Xorg，输入用户名pi和密码raspberry，点击OK</li>
<li>不出意外的话，应该就ojbk了</li>
</ol>
<hr>
<p>参考链接：</p>
<ul>
<li><a href="https://blog.csdn.net/Tavox/article/details/70994392" target="_blank" rel="noopener">树莓派第一次使用（笔记本+网线）</a></li>
<li><a href="https://blog.csdn.net/XYscript/article/details/65487038" target="_blank" rel="noopener">树莓派初次使用（史上最全最详细教程！！)</a></li>
<li><a href="https://blog.csdn.net/z3881006/article/details/72590539" target="_blank" rel="noopener">使用diskpart恢复使用win32 disk imager处理过的U盘</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">sjinglong</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">sjinglong</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  


  

  

</body>
</html>
